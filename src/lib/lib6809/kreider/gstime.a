
			psect	mytime,0,0,0,0,0

setime:		link	a5,#0
			movem.l	d1/d2/a0,-(sp)
			movea.l	d0,a0
			moveq	#$00,d1
			move.b	(a0),d1
			add.w	#1900,d1
			cmpi.w	#1970,d1		check boundary
			bge.s	_setime1		now in 1970 .. 1999
			add.w	#100,d1			now in 2000 .. 2069
_setime1	swap	d1
			move.b	1(a0),d1
			asl.w	#8,d1
			move.b	2(a0),d1
			moveq	#$00,d0
			move.b	3(a0),d0
			swap	d0
			move.b	4(a0),d0
			asl.w	#8,d0
			move.b	5(a0),d0
			os9		F$STime
			bra		_sysret0


getime:		link	a5,#0
			movem.l	d1/d2/a0,-(sp)
			movea.l	d0,a0
			moveq	#$00,d0
			movem.l	d3,-(sp)
			os9		F$Time
			movem.l	(sp)+,d3
			bcs		_os9err

_getime1	move.l	a0,d2
			swap	d1
			sub.w	#1900,d1		now in 70 .. 169
			cmpi.w	#100,d1			100 should be 0
			blt.s	_getime2
			sub.w	#100,d1
_getime2	move.b	d1,(a0)+
			swap	d1
			rol.w	#8,d1
			move.b	d1,(a0)+
			rol.w	#8,d1
			move.b	d1,(a0)+
			swap	d0
			move.b	d0,(a0)+
			swap	d0
			rol.w	#8,d0
			move.b	d0,(a0)+
			rol.w	#8,d0
			move.b	d0,(a0)+
			bra		_sysret0

			ends
